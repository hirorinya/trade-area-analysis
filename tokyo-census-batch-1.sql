-- Tokyo Census Data Batch
-- Run each batch separately in Supabase SQL Editor

ALTER TABLE population_mesh DISABLE ROW LEVEL SECURITY;

INSERT INTO population_mesh (mesh_code, center_lat, center_lng, population, mesh_level, updated_at) VALUES
('544020194', 36.177777777777784, 140.11666666666667, 15, 4, NOW()),
('544020201', 36.18611111111111, 140.00416666666666, 17, 4, NOW()),
('544020202', 36.18611111111111, 140.00416666666666, 115, 4, NOW()),
('544020203', 36.18611111111111, 140.00416666666666, 242, 4, NOW()),
('544020204', 36.18611111111111, 140.00416666666666, 313, 4, NOW()),
('544020211', 36.18611111111111, 140.01666666666665, 163, 4, NOW()),
('544020212', 36.18611111111111, 140.01666666666665, 4, 4, NOW()),
('544020213', 36.18611111111111, 140.01666666666665, 608, 4, NOW()),
('544020214', 36.18611111111111, 140.01666666666665, 110, 4, NOW()),
('544020221', 36.18611111111111, 140.02916666666667, 16, 4, NOW()),
('544020222', 36.18611111111111, 140.02916666666667, 73, 4, NOW()),
('544020223', 36.18611111111111, 140.02916666666667, 36, 4, NOW()),
('544020224', 36.18611111111111, 140.02916666666667, 91, 4, NOW()),
('544020231', 36.18611111111111, 140.04166666666666, 82, 4, NOW()),
('544020232', 36.18611111111111, 140.04166666666666, 33, 4, NOW()),
('544020234', 36.18611111111111, 140.04166666666666, 6, 4, NOW()),
('544020241', 36.18611111111111, 140.05416666666667, 5, 4, NOW()),
('544020242', 36.18611111111111, 140.05416666666667, 40, 4, NOW()),
('544020243', 36.18611111111111, 140.05416666666667, 9, 4, NOW()),
('544020244', 36.18611111111111, 140.05416666666667, 23, 4, NOW()),
('544020251', 36.18611111111111, 140.06666666666666, 59, 4, NOW()),
('544020253', 36.18611111111111, 140.06666666666666, 18, 4, NOW()),
('544020261', 36.18611111111111, 140.07916666666665, 86, 4, NOW()),
('544020262', 36.18611111111111, 140.07916666666665, 73, 4, NOW()),
('544020263', 36.18611111111111, 140.07916666666665, 41, 4, NOW()),
('544020264', 36.18611111111111, 140.07916666666665, 24, 4, NOW()),
('544020271', 36.18611111111111, 140.09166666666667, 43, 4, NOW()),
('544020272', 36.18611111111111, 140.09166666666667, 16, 4, NOW()),
('544020273', 36.18611111111111, 140.09166666666667, 85, 4, NOW()),
('544020274', 36.18611111111111, 140.09166666666667, 28, 4, NOW()),
('544020283', 36.18611111111111, 140.10416666666666, 8, 4, NOW()),
('544020284', 36.18611111111111, 140.10416666666666, 3, 4, NOW()),
('544020301', 36.19444444444445, 140.00416666666666, 117, 4, NOW()),
('544020302', 36.19444444444445, 140.00416666666666, 240, 4, NOW()),
('544020304', 36.19444444444445, 140.00416666666666, 4, 4, NOW()),
('544020311', 36.19444444444445, 140.01666666666665, 529, 4, NOW()),
('544020312', 36.19444444444445, 140.01666666666665, 336, 4, NOW()),
('544020313', 36.19444444444445, 140.01666666666665, 193, 4, NOW()),
('544020314', 36.19444444444445, 140.01666666666665, 57, 4, NOW()),
('544020321', 36.19444444444445, 140.02916666666667, 3, 4, NOW()),
('544020322', 36.19444444444445, 140.02916666666667, 12, 4, NOW()),
('544020323', 36.19444444444445, 140.02916666666667, 2, 4, NOW()),
('544020324', 36.19444444444445, 140.02916666666667, 160, 4, NOW()),
('544020331', 36.19444444444445, 140.04166666666666, 116, 4, NOW()),
('544020332', 36.19444444444445, 140.04166666666666, 25, 4, NOW()),
('544020333', 36.19444444444445, 140.04166666666666, 39, 4, NOW()),
('544020334', 36.19444444444445, 140.04166666666666, 30, 4, NOW()),
('544020341', 36.19444444444445, 140.05416666666667, 98, 4, NOW()),
('544020342', 36.19444444444445, 140.05416666666667, 28, 4, NOW()),
('544020343', 36.19444444444445, 140.05416666666667, 233, 4, NOW()),
('544020344', 36.19444444444445, 140.05416666666667, 54, 4, NOW()),
('544020351', 36.19444444444445, 140.06666666666666, 66, 4, NOW()),
('544020352', 36.19444444444445, 140.06666666666666, 54, 4, NOW()),
('544020353', 36.19444444444445, 140.06666666666666, 65, 4, NOW()),
('544020354', 36.19444444444445, 140.06666666666666, 121, 4, NOW()),
('544020361', 36.19444444444445, 140.07916666666665, 93, 4, NOW()),
('544020362', 36.19444444444445, 140.07916666666665, 9, 4, NOW()),
('544020363', 36.19444444444445, 140.07916666666665, 46, 4, NOW()),
('544020371', 36.19444444444445, 140.09166666666667, 210, 4, NOW()),
('544020372', 36.19444444444445, 140.09166666666667, 146, 4, NOW()),
('544020373', 36.19444444444445, 140.09166666666667, 3, 4, NOW()),
('544020374', 36.19444444444445, 140.09166666666667, 27, 4, NOW()),
('544020381', 36.19444444444445, 140.10416666666666, 85, 4, NOW()),
('544020383', 36.19444444444445, 140.10416666666666, 26, 4, NOW()),
('544020384', 36.19444444444445, 140.10416666666666, 166, 4, NOW()),
('544020393', 36.19444444444445, 140.11666666666667, 3, 4, NOW()),
('544021041', 36.169444444444444, 140.17916666666667, 6, 4, NOW()),
('544021051', 36.169444444444444, 140.19166666666666, 28, 4, NOW()),
('544021052', 36.169444444444444, 140.19166666666666, 32, 4, NOW()),
('544021053', 36.169444444444444, 140.19166666666666, 42, 4, NOW()),
('544021054', 36.169444444444444, 140.19166666666666, 23, 4, NOW()),
('544021061', 36.169444444444444, 140.20416666666665, 9, 4, NOW()),
('544021062', 36.169444444444444, 140.20416666666665, 24, 4, NOW()),
('544021063', 36.169444444444444, 140.20416666666665, 8, 4, NOW()),
('544021064', 36.169444444444444, 140.20416666666665, 65, 4, NOW()),
('544021072', 36.169444444444444, 140.21666666666667, 52, 4, NOW()),
('544021073', 36.169444444444444, 140.21666666666667, 29, 4, NOW()),
('544021074', 36.169444444444444, 140.21666666666667, 6, 4, NOW()),
('544021081', 36.169444444444444, 140.22916666666666, 94, 4, NOW()),
('544021082', 36.169444444444444, 140.22916666666666, 4, 4, NOW()),
('544021083', 36.169444444444444, 140.22916666666666, 70, 4, NOW()),
('544021091', 36.169444444444444, 140.24166666666667, 11, 4, NOW()),
('544021092', 36.169444444444444, 140.24166666666667, 35, 4, NOW()),
('544021093', 36.169444444444444, 140.24166666666667, 12, 4, NOW()),
('544021094', 36.169444444444444, 140.24166666666667, 32, 4, NOW()),
('544021103', 36.177777777777784, 140.12916666666666, 2, 4, NOW()),
('544021133', 36.177777777777784, 140.16666666666666, 4, 4, NOW()),
('544021134', 36.177777777777784, 140.16666666666666, 3, 4, NOW()),
('544021162', 36.177777777777784, 140.20416666666665, 24, 4, NOW()),
('544021164', 36.177777777777784, 140.20416666666665, 11, 4, NOW()),
('544021171', 36.177777777777784, 140.21666666666667, 3, 4, NOW()),
('544021172', 36.177777777777784, 140.21666666666667, 41, 4, NOW()),
('544021173', 36.177777777777784, 140.21666666666667, 5, 4, NOW()),
('544021174', 36.177777777777784, 140.21666666666667, 49, 4, NOW()),
('544021181', 36.177777777777784, 140.22916666666666, 8, 4, NOW()),
('544021183', 36.177777777777784, 140.22916666666666, 119, 4, NOW()),
('544021184', 36.177777777777784, 140.22916666666666, 15, 4, NOW()),
('544021191', 36.177777777777784, 140.24166666666667, 7, 4, NOW()),
('544021192', 36.177777777777784, 140.24166666666667, 28, 4, NOW()),
('544021193', 36.177777777777784, 140.24166666666667, 104, 4, NOW()),
('544021194', 36.177777777777784, 140.24166666666667, 116, 4, NOW()),
('544021212', 36.18611111111111, 140.14166666666665, 8, 4, NOW()),
('544021213', 36.18611111111111, 140.14166666666665, 14, 4, NOW()),
('544021214', 36.18611111111111, 140.14166666666665, 44, 4, NOW()),
('544021221', 36.18611111111111, 140.15416666666667, 2, 4, NOW()),
('544021223', 36.18611111111111, 140.15416666666667, 31, 4, NOW()),
('544021224', 36.18611111111111, 140.15416666666667, 11, 4, NOW()),
('544021231', 36.18611111111111, 140.16666666666666, 26, 4, NOW()),
('544021232', 36.18611111111111, 140.16666666666666, 32, 4, NOW()),
('544021233', 36.18611111111111, 140.16666666666666, 94, 4, NOW()),
('544021234', 36.18611111111111, 140.16666666666666, 77, 4, NOW()),
('544021241', 36.18611111111111, 140.17916666666667, 55, 4, NOW()),
('544021242', 36.18611111111111, 140.17916666666667, 4, 4, NOW()),
('544021243', 36.18611111111111, 140.17916666666667, 28, 4, NOW()),
('544021244', 36.18611111111111, 140.17916666666667, 89, 4, NOW()),
('544021271', 36.18611111111111, 140.21666666666667, 10, 4, NOW()),
('544021272', 36.18611111111111, 140.21666666666667, 145, 4, NOW()),
('544021274', 36.18611111111111, 140.21666666666667, 24, 4, NOW()),
('544021281', 36.18611111111111, 140.22916666666666, 129, 4, NOW()),
('544021282', 36.18611111111111, 140.22916666666666, 54, 4, NOW()),
('544021283', 36.18611111111111, 140.22916666666666, 62, 4, NOW()),
('544021284', 36.18611111111111, 140.22916666666666, 276, 4, NOW()),
('544021291', 36.18611111111111, 140.24166666666667, 26, 4, NOW()),
('544021292', 36.18611111111111, 140.24166666666667, 152, 4, NOW()),
('544021293', 36.18611111111111, 140.24166666666667, 37, 4, NOW()),
('544021312', 36.19444444444445, 140.14166666666665, 5, 4, NOW()),
('544021313', 36.19444444444445, 140.14166666666665, 25, 4, NOW()),
('544021314', 36.19444444444445, 140.14166666666665, 7, 4, NOW()),
('544021331', 36.19444444444445, 140.16666666666666, 14, 4, NOW()),
('544021332', 36.19444444444445, 140.16666666666666, 2, 4, NOW()),
('544021334', 36.19444444444445, 140.16666666666666, 52, 4, NOW()),
('544021342', 36.19444444444445, 140.17916666666667, 49, 4, NOW()),
('544021343', 36.19444444444445, 140.17916666666667, 44, 4, NOW()),
('544021344', 36.19444444444445, 140.17916666666667, 42, 4, NOW()),
('544021353', 36.19444444444445, 140.19166666666666, 3, 4, NOW()),
('544021354', 36.19444444444445, 140.19166666666666, 2, 4, NOW()),
('544021361', 36.19444444444445, 140.20416666666665, 8, 4, NOW()),
('544021363', 36.19444444444445, 140.20416666666665, 62, 4, NOW()),
('544021364', 36.19444444444445, 140.20416666666665, 126, 4, NOW()),
('544021372', 36.19444444444445, 140.21666666666667, 33, 4, NOW()),
('544021373', 36.19444444444445, 140.21666666666667, 120, 4, NOW()),
('544021374', 36.19444444444445, 140.21666666666667, 152, 4, NOW()),
('544021382', 36.19444444444445, 140.22916666666666, 50, 4, NOW()),
('544021383', 36.19444444444445, 140.22916666666666, 46, 4, NOW()),
('544021384', 36.19444444444445, 140.22916666666666, 30, 4, NOW()),
('544021393', 36.19444444444445, 140.24166666666667, 81, 4, NOW()),
('544021394', 36.19444444444445, 140.24166666666667, 172, 4, NOW()),
('544022001', 36.169444444444444, 140.25416666666666, 23, 4, NOW()),
('544022002', 36.169444444444444, 140.25416666666666, 70, 4, NOW()),
('544022003', 36.169444444444444, 140.25416666666666, 80, 4, NOW()),
('544022004', 36.169444444444444, 140.25416666666666, 138, 4, NOW()),
('544022011', 36.169444444444444, 140.26666666666665, 75, 4, NOW()),
('544022012', 36.169444444444444, 140.26666666666665, 100, 4, NOW()),
('544022013', 36.169444444444444, 140.26666666666665, 42, 4, NOW()),
('544022014', 36.169444444444444, 140.26666666666665, 55, 4, NOW()),
('544022022', 36.169444444444444, 140.27916666666667, 152, 4, NOW()),
('544022024', 36.169444444444444, 140.27916666666667, 100, 4, NOW()),
('544022031', 36.169444444444444, 140.29166666666666, 105, 4, NOW()),
('544022032', 36.169444444444444, 140.29166666666666, 188, 4, NOW()),
('544022033', 36.169444444444444, 140.29166666666666, 92, 4, NOW()),
('544022034', 36.169444444444444, 140.29166666666666, 28, 4, NOW()),
('544022101', 36.177777777777784, 140.25416666666666, 28, 4, NOW()),
('544022102', 36.177777777777784, 140.25416666666666, 195, 4, NOW()),
('544022103', 36.177777777777784, 140.25416666666666, 2, 4, NOW()),
('544022104', 36.177777777777784, 140.25416666666666, 3, 4, NOW()),
('544022111', 36.177777777777784, 140.26666666666665, 75, 4, NOW()),
('544022113', 36.177777777777784, 140.26666666666665, 2, 4, NOW()),
('544022114', 36.177777777777784, 140.26666666666665, 183, 4, NOW()),
('544022121', 36.177777777777784, 140.27916666666667, 6, 4, NOW()),
('544022122', 36.177777777777784, 140.27916666666667, 647, 4, NOW()),
('544022123', 36.177777777777784, 140.27916666666667, 297, 4, NOW()),
('544022124', 36.177777777777784, 140.27916666666667, 634, 4, NOW()),
('544022131', 36.177777777777784, 140.29166666666666, 385, 4, NOW()),
('544022132', 36.177777777777784, 140.29166666666666, 621, 4, NOW()),
('544022133', 36.177777777777784, 140.29166666666666, 1188, 4, NOW()),
('544022134', 36.177777777777784, 140.29166666666666, 1318, 4, NOW()),
('544022201', 36.18611111111111, 140.25416666666666, 58, 4, NOW()),
('544022204', 36.18611111111111, 140.25416666666666, 129, 4, NOW()),
('544022211', 36.18611111111111, 140.26666666666665, 24, 4, NOW()),
('544022212', 36.18611111111111, 140.26666666666665, 655, 4, NOW()),
('544022213', 36.18611111111111, 140.26666666666665, 745, 4, NOW()),
('544022214', 36.18611111111111, 140.26666666666665, 615, 4, NOW()),
('544022221', 36.18611111111111, 140.27916666666667, 755, 4, NOW()),
('544022222', 36.18611111111111, 140.27916666666667, 579, 4, NOW()),
('544022223', 36.18611111111111, 140.27916666666667, 1049, 4, NOW()),
('544022224', 36.18611111111111, 140.27916666666667, 303, 4, NOW()),
('544022231', 36.18611111111111, 140.29166666666666, 830, 4, NOW()),
('544022232', 36.18611111111111, 140.29166666666666, 1082, 4, NOW()),
('544022233', 36.18611111111111, 140.29166666666666, 575, 4, NOW()),
('544022234', 36.18611111111111, 140.29166666666666, 1326, 4, NOW()),
('544022301', 36.19444444444445, 140.25416666666666, 49, 4, NOW()),
('544022302', 36.19444444444445, 140.25416666666666, 83, 4, NOW()),
('544022303', 36.19444444444445, 140.25416666666666, 31, 4, NOW()),
('544022304', 36.19444444444445, 140.25416666666666, 138, 4, NOW()),
('544022311', 36.19444444444445, 140.26666666666665, 725, 4, NOW()),
('544022312', 36.19444444444445, 140.26666666666665, 721, 4, NOW()),
('544022313', 36.19444444444445, 140.26666666666665, 898, 4, NOW()),
('544022314', 36.19444444444445, 140.26666666666665, 1101, 4, NOW()),
('544022321', 36.19444444444445, 140.27916666666667, 759, 4, NOW()),
('544022322', 36.19444444444445, 140.27916666666667, 877, 4, NOW()),
('544022323', 36.19444444444445, 140.27916666666667, 547, 4, NOW()),
('544022324', 36.19444444444445, 140.27916666666667, 962, 4, NOW()),
('544022331', 36.19444444444445, 140.29166666666666, 1124, 4, NOW()),
('544022332', 36.19444444444445, 140.29166666666666, 484, 4, NOW()),
('544022333', 36.19444444444445, 140.29166666666666, 1281, 4, NOW()),
('544022334', 36.19444444444445, 140.29166666666666, 251, 4, NOW())
ON CONFLICT (mesh_code) DO UPDATE SET
  population = EXCLUDED.population,
  updated_at = EXCLUDED.updated_at;

-- Re-enable RLS
ALTER TABLE population_mesh ENABLE ROW LEVEL SECURITY;

-- Verify the data was inserted
SELECT 
    COUNT(*) as total_records,
    MIN(population) as min_population,
    MAX(population) as max_population,
    AVG(population)::integer as avg_population,
    mesh_level
FROM population_mesh 
GROUP BY mesh_level
ORDER BY mesh_level;

-- Sample Tokyo area data
SELECT mesh_code, center_lat, center_lng, population
FROM population_mesh
WHERE center_lat BETWEEN 35.6 AND 35.8
  AND center_lng BETWEEN 139.6 AND 139.8
ORDER BY population DESC
LIMIT 20;
ALTER TABLE population_mesh ENABLE ROW LEVEL SECURITY;

-- Check progress
SELECT COUNT(*) as loaded_records FROM population_mesh;
